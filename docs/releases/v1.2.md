# GatePulse v1.2 — Streaming 1.0 + Inbox UX

## Highlights

- **SSE cursor & resume**: `Last-Event-ID` header and `?from_cursor=SEG:OFFSET` parameter for reliable reconnection without event loss
- **Historical backfill**: Connect with `?from_cursor=0:0` to receive all past events then switch to live; configurable max events and max age
- **Delivery status stream**: All delivery attempts published to the `deliveries.status` SSE topic in real time
- **Dev Inbox UI**: Browser-based webhook inspector at `/v1/dev/inbox/ui?token=TOKEN` — no build step, vanilla JS
- **Stream metrics**: `gatepulse_stream_clients` gauge and `gatepulse_stream_events_sent_total` counter

## Breaking Changes

None. All `/v1` endpoints remain backward-compatible.

## New SSE Behavior

Every SSE event now includes an `id:` field in `SEG:OFFSET` format. Clients can pass this value as `Last-Event-ID` on reconnect to resume from the exact position.

```
id: 0:4096
event: message
data: {"topic":"orders.created","id":"evt_abc123",...}
```

After reconnect the server replays missed events, then emits `": backfill-complete"` before switching to live.

## New API Endpoints

| Method | Path | Description |
|--------|------|-------------|
| `GET` | `/v1/dev/inbox/ui` | Browser-based inbox inspector |

## New Query Parameters

| Parameter | Endpoint | Description |
|-----------|----------|-------------|
| `from_cursor` | `GET /v1/stream` | Start from `SEG:OFFSET` cursor |

## New Environment Variables

| Variable | Default | Description |
|----------|---------|-------------|
| `GP_STREAM_BACKFILL_MAX_EVENTS` | `10000` | Max events to replay on reconnect |
| `GP_STREAM_BACKFILL_MAX_AGE_DAYS` | `7` | Max age of events for backfill |

## Upgrade Notes

No migration required. SSE clients that do not send `Last-Event-ID` behave as before (live events only).
